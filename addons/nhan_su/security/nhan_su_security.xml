<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">
        
        <!-- Category cho module Nhân sự -->
        <record id="module_category_nhan_su" model="ir.module.category">
            <field name="name">Quản lý nhân sự</field>
            <field name="description">Phân quyền cho module quản lý nhân sự</field>
            <field name="sequence">15</field>
        </record>

        <!-- Group: Nhân viên kinh doanh -->
        <record id="group_nhan_vien_kinh_doanh" model="res.groups">
            <field name="name">Nhân viên kinh doanh</field>
            <field name="category_id" ref="module_category_nhan_su"/>
            <field name="comment">Soạn thảo văn bản, quản lý khách hàng được phân công</field>
        </record>

        <!-- Group: Trưởng phòng -->
        <record id="group_truong_phong" model="res.groups">
            <field name="name">Trưởng phòng</field>
            <field name="category_id" ref="module_category_nhan_su"/>
            <field name="implied_ids" eval="[(4, ref('group_nhan_vien_kinh_doanh'))]"/>
            <field name="comment">Duyệt văn bản, phân công nhân viên, xem tất cả khách hàng</field>
        </record>

        <!-- Group: Giám đốc -->
        <record id="group_giam_doc" model="res.groups">
            <field name="name">Giám đốc</field>
            <field name="category_id" ref="module_category_nhan_su"/>
            <field name="implied_ids" eval="[(4, ref('group_truong_phong'))]"/>
            <field name="comment">Phê duyệt cuối cùng, toàn quyền quản lý hệ thống</field>
        </record>

        <!-- Group: Quản trị nhân sự - kế thừa từ base.group_system để admin có quyền -->
        <record id="group_quan_tri_nhan_su" model="res.groups">
            <field name="name">Quản trị nhân sự</field>
            <field name="category_id" ref="module_category_nhan_su"/>
            <field name="implied_ids" eval="[(4, ref('group_giam_doc'))]"/>
            <field name="users" eval="[(4, ref('base.user_admin'))]"/>
            <field name="comment">Quản lý nhân viên, vai trò, phân quyền</field>
        </record>

        <!-- Record Rules cho Nhân viên -->
        <record id="nhan_vien_rule_nhan_vien_kinh_doanh" model="ir.rule">
            <field name="name">Nhân viên: Chỉ xem nhân viên đang làm việc</field>
            <field name="model_id" ref="model_nhan_vien"/>
            <field name="domain_force">[('trang_thai_lam_viec', '=', 'dang_lam')]</field>
            <field name="groups" eval="[(4, ref('group_nhan_vien_kinh_doanh'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="nhan_vien_rule_truong_phong" model="ir.rule">
            <field name="name">Trưởng phòng: Xem tất cả nhân viên</field>
            <field name="model_id" ref="model_nhan_vien"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_truong_phong'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="nhan_vien_rule_giam_doc" model="ir.rule">
            <field name="name">Giám đốc: Xem tất cả nhân viên</field>
            <field name="model_id" ref="model_nhan_vien"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_giam_doc'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="nhan_vien_rule_quan_tri" model="ir.rule">
            <field name="name">Quản trị: Toàn quyền nhân viên</field>
            <field name="model_id" ref="model_nhan_vien"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_quan_tri_nhan_su'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Record Rules cho Chấm công -->
        <record id="cham_cong_rule_nhan_vien" model="ir.rule">
            <field name="name">Chấm công: Chỉ xem chấm công của mình</field>
            <field name="model_id" ref="model_cham_cong"/>
            <field name="domain_force">[('nhan_vien_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_nhan_vien_kinh_doanh'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="cham_cong_rule_truong_phong" model="ir.rule">
            <field name="name">Chấm công: Trưởng phòng xem tất cả</field>
            <field name="model_id" ref="model_cham_cong"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_truong_phong'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <record id="cham_cong_rule_quan_tri" model="ir.rule">
            <field name="name">Chấm công: Quản trị xem tất cả</field>
            <field name="model_id" ref="model_cham_cong"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_quan_tri_nhan_su'))]"/>
        </record>

        <!-- Record Rules cho Bảng lương -->
        <record id="bang_luong_rule_nhan_vien" model="ir.rule">
            <field name="name">Bảng lương: Chỉ xem lương của mình</field>
            <field name="model_id" ref="model_bang_luong"/>
            <field name="domain_force">[('nhan_vien_id.user_id', '=', user.id)]</field>
            <field name="groups" eval="[(4, ref('group_nhan_vien_kinh_doanh'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="False"/>
            <field name="perm_create" eval="False"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="bang_luong_rule_truong_phong" model="ir.rule">
            <field name="name">Bảng lương: Trưởng phòng xem tất cả</field>
            <field name="model_id" ref="model_bang_luong"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_truong_phong'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="False"/>
        </record>

        <record id="bang_luong_rule_quan_tri" model="ir.rule">
            <field name="name">Bảng lương: Quản trị toàn quyền</field>
            <field name="model_id" ref="model_bang_luong"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('group_quan_tri_nhan_su'))]"/>
        </record>

    </data>
</odoo>
